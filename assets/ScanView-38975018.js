import{L as c}from"./LayoutHeader-666f4c4f.js";import{L as d}from"./LayoutFooter-35dbfd97.js";import{o as n,c as s,e as i,a as r,g as m,u as h,b as l,F as p,V as a}from"./index-098e3105.js";const f={class:"container"},v={class:"row justify-content-md-center"},b={class:"col-md-6 mt-2"},y=r("div",{class:"alert alert-light mb-2",role:"alert"}," 請將相機對準QRCode ",-1),g={class:"mb-1"},S={key:0,class:"text-center mt-2"},E={components:{LayoutHeader:c,LayoutFooter:d,QrcodeStream:a.QrcodeStream,QrcodeDropZone:a.QrcodeDropZone,QrcodeCapture:a.QrcodeCapture},props:["env","api_url","client_info"],data(){return{exhibition:this.getMyData("exhibition"),loading:!0,destroyed:!1,paused:!1,qrcode:""}},created(){},computed:{},methods:{getMyData(e){let t=localStorage.getItem(e)||null;if(typeof t=="string")try{t=JSON.parse(t)}catch{}return t},setMyData(e,t){typeof t=="object"&&(t=JSON.stringify(t)),localStorage.setItem(e,t)},send(){navigator.vibrate([200,100,200]),this.$router.push("/search/SFGJA2818")},onCamera(e){this.loading=!1},async onDetect(e,t){this.paused=!0,e.then(o=>{this.qrcode=o.content,this.qrcode&&(navigator.vibrate([200,100,200]),this.$router.push("/search/"+this.qrcode))}),this.paused=!1},onError(e){error.value=`[${e.name}]: `,e.name==="NotAllowedError"?error.value+="you need to grant camera access permission":e.name==="NotFoundError"?error.value+="no camera on this device":e.name==="NotSupportedError"?error.value+="secure context required (HTTPS, localhost)":e.name==="NotReadableError"?error.value+="is the camera already in use?":e.name==="OverconstrainedError"?error.value+="installed cameras are not suitable":e.name==="StreamApiNotSupportedError"?error.value+="Stream API is not supported in this browser":e.name==="InsecureContextError"?error.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":error.value+=e.message}},mounted(){}},D=Object.assign(E,{__name:"ScanView",setup(e){return(t,o)=>(n(),s(p,null,[i(c,{env:e.env,client:e.client_info,exhibition:t.exhibition},null,8,["env","client","exhibition"]),r("div",f,[r("div",v,[r("div",b,[y,r("div",g,[t.destroyed?l("",!0):(n(),m(h(a.QrcodeStream),{key:0,paused:t.paused,onError:t.onError,onDetect:t.onDetect,onCameraOn:t.onCamera},null,8,["paused","onError","onDetect","onCameraOn"]))])])]),e.api_url=="localhost"?(n(),s("div",S,[r("button",{type:"button",class:"btn btn-link btn-lg rounded-pill px-5",onClick:o[0]||(o[0]=(...u)=>t.send&&t.send(...u))},"測試送出核銷結果")])):l("",!0)]),i(d,{env:e.env,client:e.client_info},null,8,["env","client"])],64))}});export{D as default};
